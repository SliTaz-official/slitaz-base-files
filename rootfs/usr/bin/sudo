#!/bin/sh
#
# Sudo wrapper using Busybox su applet.
# Copyright (C) 2014 SliTaz GNU/Linux.
#

cmd="$@"
pwd="$(pwd)"
conf="$HOME/.config/slitaz/subox.conf"

# Saved root password
if [ -f "$conf" ]; then
	pass="$(cat $conf)"
fi

case "$1" in
	usage|*help|"")
		echo -e "\nExecute a command as root"
		echo -e "Usage: $(basename $0) [command]\n" ;;
	*)
		if [ "$pass" ]; then
			echo "$pass" | su -c "cd $pwd; $cmd"
		else
			su -c "cd $pwd; $cmd"
		fi ;;
esac
exit 0
